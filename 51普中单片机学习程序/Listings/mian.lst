C51 COMPILER V9.01   MIAN                                                                  10/27/2020 22:32:56 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE MIAN
OBJECT MODULE PLACED IN .\Objects\mian.obj
COMPILER INVOKED BY: B:\Keil\C51\BIN\C51.EXE mian.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\mian.ls
                    -t) OBJECT(.\Objects\mian.obj)

line level    source

   1          #include <reg51.h>
   2          #include <intrins.h>
   3          #include <i2c.h>
   4          
   5          #define A P2                                //∂®“Â“ª◊ÈI/Oø⁄£¨∑Ω±„∂‘∂‡¥¶µ˜”√Õ¨“ªI/Oµƒ–ﬁ∏ƒ£®±„”⁄≥Ã–Ú“∆÷≤£©  
             -          //#define∫Í∂®“Â£¨”√”⁄∂®“Â≥£¡ø£®∞¸¿®Œﬁ≤Œ¡ø”Î¥¯≤Œ¡ø£©
   6          #define LED P0                             //∞À∂Œ ˝¬Îπ‹I/Oø⁄∂®“Â
   7          #define GPIO_Key P1                        //æÿ’Û∞¥º¸I/Oø⁄∂®
   8          
   9          typedef unsigned int uint16;
  10          typedef unsigned long int uint32;
  11          typedef unsigned char uchar8;
  12          
  13          
  14          sbit FM=P1^5;                             //∂®“Â∑‰√˘∆˜I/Oø⁄
  15          
  16          sbit LSA=P2^2;                            //∂®“Â ˝¬Îπ‹∆¨—°–≈∫≈I/Oø⁄
  17          sbit LSB=P2^3;                            //AŒ™µÕŒª£¨BŒ™∏ﬂŒª
  18          sbit LSC=P2^4;
  19          
  20          
  21          sbit Led2=P2^2;                          //∂®“Â∂¿¡¢I/Oø⁄,±„”⁄∂‘∂¿¡¢I/Oø⁄µƒ±Ê ∂ 
  22          
  23          sbit K2=P3^0; 
  24          sbit K1=P3^1;                            //∂®“Â∂¿¡¢∞¥º¸          Œƒº˛»´æ÷±‰¡øµƒ∂®“Â£¨∏√±‰¡øΩˆ‘⁄∏√.cŒƒº˛÷–±
             -ª»´æ÷“˝”√                    
  25          sbit K3=P3^2;
  26          sbit K4=P3^3; 
  27          
  28          
  29          
  30          sbit SER=P3^4;                              //DS-¥Æ–– ˝æ› ‰»Î
  31          sbit RCLK=P3^5;                            //STCP-¥Ê¥¢ºƒ¥Ê∆˜ ±÷”£®¥•∑¢π§◊˜µƒ–≈∫≈£© ‰»Î              
  32          sbit SRCLK=P3^6;                           //SHCP-“∆Œªºƒ¥Ê∆˜ ±÷”£®¥•∑¢π§◊˜µƒ–≈∫≈£© ‰»Î
  33           
  34          
  35          void Delay_s(uint16 n);                    //12Mæß’Ò—”≥Ÿn√Î                  //—” ±∫Ø ˝µƒ∂®“Â
  36          void Delay_ms(uint16 n);                   //12Mæß’Ò—”≥Ÿn∫¡√Î                
  37          void Delay_us(uint16 n);                  //12Mæß’Ò—”≥Ÿn/100∫¡√Ó
  38          
  39          void Keydown();                           //4°¡4æÿ’Ûº¸≈Ã—≠ª∑…®√Ë£¨¥”◊Û…œµΩ”“œ¬£¨“¿¥ŒŒ™ ˝¬Îπ‹ ˝◊È÷–µƒ0~F
  40          uchar8  Keyvalue;
  41          
  42          void Hc595SendByte(uchar8 dat);               //595œ»¥´ÀÕ∏ﬂŒª£¨‘Ÿ¥´ÀÕµÕŒª
  43          
  44          void Key_Led(void);                      //∞¥º¸øÿ÷∆LEDµ„¡¡∫Õœ®√
  45          void LED_Key();                          //”¶”√4°¡4º¸≈Ã π ˝¬Îπ‹∂‘”√œ‘ æ0~F
  46          void Key_Led(void);                      //∞¥º¸øÿ÷∆LEDµ„¡¡
  47          
  48          void smgj(void);                         //æ≤Ã¨ ˝¬Îπ‹œ‘ æ 
  49          void smgd1(void);                        //æ≤Ã¨ ˝¬Îπ‹—≠ª∑œ‘ æ0~F 
  50          void smgd2(void);                        //8∏ˆ ˝¬Îπ‹¡˜ÀÆ—≠ª∑œ‘ æ0~7
  51          
  52          void FMQ(void);                          //∑‰√˘∆˜≥Ã–Ú
C51 COMPILER V9.01   MIAN                                                                  10/27/2020 22:32:56 PAGE 2   

  53          
  54          void Keypros();
  55          void DigDisplay();
  56          void datapros();
  57          
  58          void Int0Init();                          //Õ‚≤ø÷–∂œ0≥ı ºªØ≥Ã–Ú
  59                                                    //‘À”√Õ‚≤ø÷–∂œ0øÿ÷∆∞¥º¸K3 µœ÷∂‘LEDµ∆D2µƒ¡¡√øÿ÷∆
  60          void Time0Init();                          //∂® ±/º∆ ˝∆˜T0≥ı ºªØ≥Ã–Ú°™°™°™°™–Ë‘⁄÷˜∫Ø ˝÷–“˝”√∏ƒ∫Ø ˝
  61                                                    //‘À”√∂® ±/º∆ ˝∆˜TO µœ÷∂‘LEDµ∆D2µƒ—≠ª∑µ„¡¡
  62          void UsartInit();                         //¥Æø⁄Õ®–≈≥ı ºªØ∫Ø ˝                         
  63                                                    //‘À”√∂® ±∆˜ µœ÷¥Æø⁄Õ®–≈
  64          
  65          void LED_one(void);                      //∂¿¡¢Ledµƒµ„¡¡                    //÷¥––≥Ã–Úµƒ∂®“Â
  66          void LED_cror(void);                     //‘À”√—≠ª∑“∆Œª∫Ø ˝µ„LED¡˜ÀÆµ∆
  67          void LED_crol1(void);                    //‘À”√ ˝◊È µœ÷LED¡˜ÀÆµ∆
  68          void LED_crol2(void);                   //º∆ ˝–Õ¡˜ÀÆµ∆
  69          
  70          void HC595_send_data(uchar8 dat);      //LEDµ„’Û––…®√Ë
  71          void Led_dz1(void);                        //ledµ„’Ûµ„¡¡◊Û…œΩ«µ∆
  72          void LED_dianzhen_gexingzi(void);                                     //‘À”√LEDµ„’Û◊‘∂®“Âœ‘ æ∫∫◊÷
  73          uchar8 code Led_duan[]={0x00,0x02,0x52,0x7e,0x52,0x7e,0x02,0x00};                   //∫∫◊÷°∞≥Û°±
  74          //uchar8 code Led_duan[]={0xff,0x91,0xaf,0x8b,0x8b,0xaf,0x91,0xff};                 //∫∫◊÷°∞áÂ°±
  75          //uchar8 code Led_duan[]={0x3c,0x42,0x00,0x42,0x24,0x18,0x24,0x42};                //◊÷ƒ∏ CX
  76          //uchar8 code Led_duan[]={0x00,0x00,0x3e,0x41,0x41,0x41,0x3e,0x00};                //LEDµ„’Ûœ‘ æ¡„£¨∂Œ—°–≈
             -∫≈£®—°÷–ƒ≥º∏––£©---∞¥¡–∂¡16Œª÷µ--∏ƒ±‰¥À ˝◊È£¨¥ÔµΩœ‘ æ≤ªÕ¨◊÷µƒƒøµÿ
  77          uchar8 code Led_wei[]={0x7f,0xbf,0xdf,0xef,0xf7,0xfb,0xfd,0xfe};                   //LEDµ„’Ûœ‘ æ¡„£¨Œª—°–≈
             -∫≈£®—°÷–ƒ≥¡–£©---∞¥––∂¡16Œª÷µ---±æ ˝◊È≤ª±‰
  78          
  79          uchar8 code smgduan[]={0x3f,0x06,0x5b,0x4f,0x66,0x6d,0x7d,0x07,
  80                                 0x7f,0x6f,0x77,0x7c,0x39,0x5e,0x79,0x71,0x00};             //∆ﬂ∂Œ ˝¬Îπ‹∂‘”¶0~Fœ‘ æ÷
             -µ ˝◊È               ‘⁄.cŒƒº˛÷–∂®“Â ˝◊È£¨ ˝◊Èø…¥Ê¥¢‘⁄Flash÷–£®∂®“Â ±ø…∞¸∫¨code£©
  81          uchar8 num=0,disp[4];
  82          
  83                                                     
  84          void main()
  85          {
  86   1              while(1)
  87   1              {
  88   2                Keypros();
  89   2                datapros();
  90   2                DigDisplay();
  91   2              }
  92   1      }
  93          
  94          void Keypros()
  95          {
  96   1              if(K1==0)
  97   1              {
  98   2                      Delay_ms(5);
  99   2                      if(K1==0)
 100   2                      {
 101   3                              At24c02Write(1,num);
 102   3                      }
 103   2                  while(!K1);
 104   2              }
 105   1              if(K2==0)
 106   1              {
 107   2                      Delay_ms(5);
 108   2                      if(K2==0)
 109   2                      {
 110   3                              num=At24c02Read(1);
 111   3                      }       
C51 COMPILER V9.01   MIAN                                                                  10/27/2020 22:32:56 PAGE 3   

 112   2                      while(!K2);
 113   2              }
 114   1              if(K3==0)
 115   1              {
 116   2                      Delay_ms(5);
 117   2                      if(K3==0)
 118   2                      {
 119   3                              num++;
 120   3      //                      if(num>255)num=0;     //ifµ•”Ôæ‰÷¥––√¸¡Ó–¥∑®
 121   3                              if(num>255)           //if”Ôæ‰µƒÕÍ’˚”√∑®
 122   3                              {
 123   4                                      num=0;
 124   4                              }
 125   3                      }
 126   2                  while(!K3);
 127   2              }       
 128   1              if(K4==0)
 129   1              {
 130   2                      Delay_ms(5);
 131   2                      if(K4==0)
 132   2                      {
 133   3                              num=0;
 134   3                      }       
 135   2                      while(!K4);
 136   2              }       
 137   1      }
 138          
 139          void DigDisplay()
 140          {
 141   1              uchar8 i;
 142   1              for(i=0;i<4;i++)
 143   1              {
 144   2                      switch(i)        //Œª—°£¨—°‘Òµ„¡¡µƒ ˝¬Îπ‹£¨
 145   2                      {
 146   3                              case(0):
 147   3                                      LSA=0;LSB=0;LSC=0; break;//œ‘ æµ⁄0Œª
 148   3                              case(1):
 149   3                                      LSA=1;LSB=0;LSC=0; break;//œ‘ æµ⁄1Œª
 150   3                              case(2):
 151   3                                      LSA=0;LSB=1;LSC=0; break;//œ‘ æµ⁄2Œª
 152   3                              case(3):
 153   3                                      LSA=1;LSB=1;LSC=0; break;//œ‘ æµ⁄3Œª    
 154   3                      }
 155   2                      P0=disp[3-i];//∑¢ÀÕ ˝æ›
 156   2                      Delay_ms(5); //º‰∏Ù“ª∂Œ ±º‰…®√Ë 
 157   2                      P0=0x00;//œ˚“˛
 158   2              }               
 159   1      }
 160                  
 161          void datapros()
 162          {
 163   1              disp[0]=smgduan[num/1000];//«ßŒª
 164   1              disp[1]=smgduan[num%1000/100];//∞ŸŒª
 165   1              disp[2]=smgduan[num%1000%100/10];//∏ˆŒª
 166   1              disp[3]=smgduan[num%1000%100%10];               
 167   1      }
 168          
 169          void UsartInit()                                                   //¥Æø⁄Õ®–≈≥ı ºªØ∫Ø ˝ 
 170          {                                                                  //‘À”√∂® ±∆˜ µœ÷¥Æø⁄Õ®–≈
 171   1              TMOD=0x20;                                                     //»∑∂®T1µƒπ§◊˜∑Ω Ω0010 0000°™°™—°‘ÒT1∂® ±/
             -º∆ ˝∆˜ —°‘Ò∂® ±ƒ£ Ω …Ë÷√π§◊˜∑Ω ΩŒ™∑Ω Ω2  
 172   1              TH1=0xf3;                                                    //≈‰÷√∂® ±∆˜≥ı÷µ ≈‰÷√ºƒ¥Ê∆˜∏ﬂÀƒŒª=≥Ã–Úº∆À„÷µ
C51 COMPILER V9.01   MIAN                                                                  10/27/2020 22:32:56 PAGE 4   

             -°™°™ø…”√51≤®Ãÿ¬ ≥ı÷µ…Ë∂®–°≥Ã–Úº∆À„
 173   1              TL1=0xf3;                                                   //               ≈‰÷√ºƒ¥Ê∆˜µÕÀƒŒª=∆‰÷µ”Î∏ﬂÀƒŒ
             -ªœ‡Õ¨
 174   1              PCON=0x80;                                                  //≈‰÷√PCONºƒ¥Ê∆˜°™°™—°‘Ò «∑ÒΩ¯––≤®Ãÿ¬ ±∂‘ˆŒª£
             -®SMOD£©1000 0000°™°™‘⁄∑Ω Ω1/2/3÷–£¨≤®Ãÿ¬ ”ÎSMOD”–πÿ°™°™µ±SMOD=1 ±£¨≤®Ãÿ¬ Ã·∏ﬂ“ª±∂£ª∏¥Œª ±£¨SMOD=0
 175   1              TR1=1;                                                     //∆Ù∂ØT1£®±‡≥ÃTCON÷–µƒTR1Œª£© ø™∂® ±∆˜£¨TR0=1 
             -±£¨∂® ±∆˜ø™ ºπ§◊˜
 176   1              SCON=0x50;                                                 //»∑∂®¥Æ––ø⁄øÿ÷∆£®±‡≥ÃSCONºƒ¥Ê∆˜£©0101 0000 SM
             -0=0£¨SM1=1—°‘Òøÿ÷∆∑Ω ΩŒ™∑Ω Ω1 SM2=0πÿ±’∂‡ª˙Õ®–≈ REN=1∆Ù∂Ø¥Æ––ø⁄Ω” ’ ˝æ›
 177   1              ES=1;                                                     //ø™¥Æ––ø⁄÷–∂œ‘ –ÌŒª
 178   1              EA=1;                                                     //ø™CPU÷–∂œ‘ –Ì£®◊‹‘ –ÌŒª£©
 179   1      }
 180          
 181          void Usart() interrupt 4                                       //¥Æø⁄Õ®–≈∑˛ŒÒ∫Ø ˝              
 182          {
 183   1              uchar8 receiveData;                                        //∂®“Â ˝æ›¥Ê¥¢±‰¡ø
 184   1              receiveData=SBUF;                                          //PC∑¢ÀÕ ˝æ›µΩSBUF£®¥À ±≥‰µ± ˝æ›Ω” ’ª∫¥Ê∆˜£©∫Û
             -£¨Ω´∆‰∏≥÷µ∏¯±‰¡øΩ¯––¥¢¥Ê
 185   1              RI=0;                                                     //“ª÷° ˝æ›¥´ ‰Ω· ¯ª·≥ˆœ÷Õ£÷πŒª£®RIΩ” ’÷–∂œ±Í÷æŒ
             -ª£©£¨ƒ⁄≤ø”≤º˛ª·◊‘∂Ø πRI=1£¨œÚ÷–∂œ∑¢≥ˆ÷–∂œ…Í«Î°™°™Œ™±„”⁄œ¬¥Œ ˝æ›µƒΩ” ’£¨π ¥À¥¶–Ë»Ìº˛ªÿ¡„
 186   1              SBUF=receiveData;                                         //±‰¡øΩ´÷µ∏≥∏¯SBUF£®¥À ±≥‰µ± ˝æ›∑¢ÀÕª∫¥Ê∆˜£©£¨≤
             -¢”…PC∂¡»°SBUF÷–µƒ ˝æ›£¨¥ÔµΩœÚPC∑¢ÀÕ ˝æ›µƒƒøµƒ
 187   1              while(!TI);                                               // ˝æ›Œ¥∑¢ÀÕÕÍ ±TI=0£ª≥Ã–Úª·Õ£‘⁄∏√¥¶£¨µ»¥˝ ˝æ›∑
             -¢ÀÕ°™°™µ± ˝æ›∑¢ÀÕΩ· ¯ ±£¨≥ˆœ÷∑¢ÀÕÕ£÷πŒª£¨¥À ±ƒ⁄≤ø”≤º˛◊‘∂Ø πTI=1£¨≥Ã–ÚÃ¯≥ˆ∏√”Ôæ‰£¨Õ¨ ±CPU∑¢≥ˆ÷–∂œ…Í«Î
 188   1              TI=0;                                                     //“ª÷° ˝æ›¥´ ‰Ω· ¯ª·≥ˆœ÷Õ£÷πŒª£®TI∑¢ÀÕ÷–∂œ±Í÷æŒ
             -ª£©£¨ƒ⁄≤ø”≤º˛ª·◊‘∂Ø πTI=1£¨œÚ÷–∂œ∑¢≥ˆ÷–∂œ…Í«Î°™°™Œ™±„”⁄œ¬¥Œ ˝æ›µƒ∑¢ÀÕ£¨π ¥À¥¶–Ë»Ìº˛ªÿ¡„
 189   1      }
 190          
 191          //void main£®£©                                                   //÷–∂œ/∂® ±∆˜’˝Ω‚
 192          //{
 193          //      Time0Init();
 194          //      while(1);                                                    //“˝”√Õ‚≤ø÷–∂œªÚ’ﬂ∂® ±∆˜ ±£¨±ÿ–Î”–¥ÀwhileΩ
             -·ππÃÂ”Ôæ‰
 195          //}
 196          
 197          
 198          //void main£®£©                                                   //÷–∂œ/∂® ±∆˜¥ÌŒÛ–¥∑®
 199          //{
 200          //      while(1)                                                      //“˝”√Õ‚≤ø÷–∂œªÚ’ﬂ∂® ±∆˜ ±£¨≤ªƒ‹≤…”√¥Àwhi
             -leΩ·ππÃÂ”Ôæ‰
 201          //      {
 202          //        Time0Init();
 203          //      }                                                    
 204          //}
 205          
 206          
 207          void Time0Init()                                                     //∂® ±/º∆ ˝∆˜T0≥ı ºªØ∫Ø ˝°™°™°™°™–Ë‘⁄
             -÷˜∫Ø ˝÷–“˝”√∏ƒ∫Ø ˝
 208          {                                                                   //‘À”√∂® ±/º∆ ˝∆˜TO µœ÷∂‘LEDµ∆D2µƒ—≠ª∑
             -µ„¡¡
 209   1      //  TMOD=0x01;
 210   1              TMOD|=0x01;                                                     //¥À∑®±»Ωœ…œÃı”Ôæ‰ø…‘ˆº”≥Ã–ÚŒ»∂®–‘ π§◊˜∑Ω
             - Ωºƒ¥Ê∆˜≈‰÷√°™°™0000 0001°™°™—°‘ÒT0∂® ±/º∆ ˝∆˜ —°‘Ò∂® ±ƒ£ Ω …Ë÷√π§◊˜∑Ω ΩŒ™∑Ω Ω1  GATE£®√≈ø’Œª£©=0 ±£¨øÿ÷∆∂® ±∆˜µƒ∆Ù∂Ø ‹Õ
             -‚≤ø÷–∂œ‘¥–≈∫≈µƒ”∞œÏ£¨÷ª“™”√»Ìº˛ πTCON÷–µƒTR0ªÚTR1Œ™1£¨≤≈ø…“‘∆Ù∂Ø∂® ±/º∆ ˝∆˜
 211   1              TH0=0xfc;                                                     //≈‰÷√∂® ±∆˜≥ı÷µ ≈‰÷√ºƒ¥Ê∆˜∏ﬂÀƒŒª°™°™≥ı÷µ=6
             -5536-∂® ± ±º‰=65535-∂® ± ±º‰+1                                                   GATE£®√≈ø’Œª£©=1 ±£¨“™”√»Ìº˛ πTR0ªÚTR1Œ
             -™1£¨Õ¨ ±Õ‚≤ø÷–∂œ“˝Ω≈INT0/1“≤Œ™∏ﬂµÁ∆Ω ±£¨≤≈ƒ‹∆Ù∂Ø∂® ±/º∆ ˝∆˜π§◊˜
 212   1              TL0=0x18;                                                                    //≈‰÷√∂® ±∆˜µÕÀƒŒª 
 213   1              ET0=1;                                                     //∂® ±/º∆ ˝∆˜÷–∂œ‘ –ÌŒª
 214   1              EA=1;                                                     //CPU÷–∂œ‘ –ÌŒª£®◊‹‘ –ÌŒª=÷–∂œ◊‹ø™πÿ£©
 215   1              TR0=1;                                                     //ø™∂® ±∆˜£¨TR0=1 ±£¨∂® ±∆˜ø™ ºπ§◊˜
 216   1      }
C51 COMPILER V9.01   MIAN                                                                  10/27/2020 22:32:56 PAGE 5   

 217          
 218          void Time0() interrupt 1                                      //∂® ±/º∆ ˝∆˜∑˛ŒÒ∫Ø ˝°™°™÷–∂œ∑¢…˙ ±◊‘∂Ø÷¥––∏
             -√◊”∫Ø ˝°™°™÷˜∫Ø ˝÷–Œﬁ–Ëµ˜”√
 219          {
 220   1              static uint16 i;                                         //æ÷≤ø(Ωˆ‘⁄∏√◊”∫Ø ˝÷–∂®“Âµƒ±‰¡ø)æ≤Ã¨±‰¡ø£¨¥À¥¶Ωˆ
             -‘⁄≥Ã–Úƒ⁄≤ø“˝”√£¨÷ªª·‘⁄≥Ã–Ú ◊¥Œ÷¥–– ±±ª≥ı ºªØ£¨≥Ã–Ú÷¥––“ª¥Œ∫Ûª·±£¡Ù–¬÷µ£¨◊˜Œ™œ¬¥Œ≥Ã–Ú÷¥––µƒ≥ı º÷µ
 221   1              TH0=0xfc;                                                //≈‰÷√∂® ±∆˜≥ı÷µ ≈‰÷√ºƒ¥Ê∆˜∏ﬂÀƒŒª
 222   1              TL0=0x18;                                                              //≈‰÷√∂® ±∆˜µÕÀƒŒª°™°™¥Àπ§◊˜∑Ω Ωœ¬
             -£®∑Ω Ω1£©£¨Œﬁ∑®◊‘∂Ø÷ÿ◊∞≥ı÷µ£¨π –Ë‘⁄÷–∂œ÷¥––◊”∫Ø ˝÷– ÷∂Ø÷ÿ◊∞≥ı÷µ
 223   1              i++;                                                    //µ±º∆ ˝∆˜º∆¬˙£¨∑¢…˙“Á≥ˆ ±Ã¯◊™÷¡∏√◊”∫Ø ˝£¨÷¥––µΩ¥
             -À”Ôæ‰ ±£¨Ã¯≥ˆ÷–∂œ£¨√ø¥Œ∏√◊”∫Ø ˝÷¥––“ª¥Œ£¨±Ì æ“—æ≠º∆ ˝1ms£®i÷¥––i+1≤Ÿ◊˜£©£¨
 224   1              if(i==1000)                                                    //µ±i¿€º”÷¡1000£®º¥1s£© ±£¨÷¥––∏√if”Ôæ‰£¨ 
             -µœ÷LEDµ∆D1µƒ◊¥Ã¨Ã¯±‰
 225   1              {
 226   2                      i=0;                                                    //√ø¥ŒLED◊¥Ã¨Ã¯±‰∫Û£¨–ËΩ´i«Â¡„£¨»√∆‰÷ÿ–¬º∆ ˝£¨±„
             -”⁄º∆À„œ¬¥ŒÃ¯±‰ ±º‰
 227   2                      Led2=~Led2;
 228   2              }
 229   1      }
 230          
 231          
 232          void Int0Init()                                                //Õ‚≤ø÷–∂œ0≥ı ºªØ≥Ã–Ú°™°™–Ë‘⁄÷˜∫Ø ˝÷–“˝”√∏ƒ
             -∫Ø ˝°™°™÷˜∫Ø ˝÷–Œﬁ–Ëµ˜”√
 233          {                                                              //‘À”√Õ‚≤ø÷–∂œ0øÿ÷∆∞¥º¸K3 µœ÷∂‘LEDµ∆D1µƒ¡¡√
             -øÿ÷∆
 234   1              IT0=1;                                                     //Õ‚≤ø÷–∂œ0¥•∑¢∑Ω Ωøÿ÷∆Œª°™°™IT0=0 ±Œ™µÕµÁ∆Ω¥•
             -∑¢£ªIT0=1 ±Œ™œ¬Ωµ—ÿ¥•∑¢
 235   1              EX0=1;                                                     //Õ‚≤ø÷–∂œ0÷–∂œøÿ÷∆±Í÷æŒª
 236   1              EA=1;                                                     //CPU÷–∂œ‘ –Ì£®◊‹‘ –ÌŒª=÷–∂œ◊‹ø™πÿ£©
 237   1      }
 238          
 239          void Int0() interrupt 0                                      // ÷–∂œ∑˛ŒÒ∫Ø ˝°™°™÷–∂œ∑¢…˙ ±£¨–Ë“™÷¥––µƒ∂Ø◊˜
             -£®÷˜∫Ø ˝÷–≤ªµ˜”√∏√◊”∫Ø ˝£©     //void   Int0()         interrupt       0
 240          {                                                                                                         
             -                          //      ÷–∂œ∫Ø ˝√˚                     ÷–∂œ∫≈
 241   1              Delay_ms(5);
 242   1              if(K3==0)
 243   1              {
 244   2                      Led2=~Led2;
 245   2              }
 246   1      }
 247          
 248          
 249          void LED_dianzhen_gexingzi(void)                                     //‘À”√LEDµ„’Û◊‘∂®“Âœ‘ æ∫∫◊÷
 250          {
 251   1                      uchar8 i;
 252   1                      LED=0x7f;
 253   1                      for(i=0;i<8;i++)
 254   1                      {
 255   2                              LED=Led_wei[i];                 //Ω¯––¡–…®√Ë
 256   2                              Hc595SendByte(Led_duan[i]);     //Ω¯––––…®√Ë
 257   2                              Delay_us(100);
 258   2                              Hc595SendByte(0x00);            //∂‘µ„’Û«Â∆¡
 259   2                      }
 260   1      }
 261                                                                                                   
 262          void Led_dz1(void)                         //ledµ„’Ûµ„¡¡◊Û…œΩ«µ∆
 263          {   
 264   1          Hc595SendByte(0x80);                      //—°‘Ò––
 265   1          LED=0x7f;                                  //—°‘Ò¡–
 266   1      }
 267          
C51 COMPILER V9.01   MIAN                                                                  10/27/2020 22:32:56 PAGE 6   

 268          
 269          void Hc595SendByte(uchar8 dat)           //––—°‘Ò/∂Œ—°∫Ø ˝       //HC595œ»¥´ÀÕ∏ﬂŒª£¨‘Ÿ¥´ÀÕµÕŒª  µ±OE£®JOE£
             -©Œ™µÕµÁ∆Ω ±–æ∆¨π§◊˜
 270          {
 271   1              uchar8 i;
 272   1              SRCLK=0;                                  //SHCP-“∆Œªºƒ¥Ê∆˜ ±÷”£®¥•∑¢π§◊˜µƒ–≈∫≈£© ‰»Î
 273   1              RCLK=0;                                   //STCP-¥Ê¥¢ºƒ¥Ê∆˜ ±÷”£®¥•∑¢π§◊˜µƒ–≈∫≈£© ‰»Î  
 274   1              for(i=0;i<8;i++)                            //÷¥––8¥Œ∫ÛΩ´8Œª ˝æ›¥Ê¥¢÷¡“∆Œª ˝æ›¥Ê¥¢ºƒ¥Ê∆˜  
 275   1              {
 276   2                      SER=dat>>7;                             //a=0 ±£¨∑¢ÀÕ◊Ó∏ﬂŒª£¨»Á£∫dat=10101110 ,‘Ú”““∆∆ﬂ¥Œ∫Û£¨Ωˆ £œ¬◊Ó∏ﬂŒ
             -ªµƒ1£¨
 277   2                      dat<<=1;                                                         //∏ﬂŒª°™°™µÕŒª
 278   2                      SRCLK=1; 
 279   2                      _nop_();                               //÷¥––“ª¥Œ—” ±“ª∏ˆª˙∆˜÷‹∆⁄
 280   2                      _nop_();                
 281   2                      SRCLK=0;                                //Ω´“∆Œªºƒ¥Ê∆˜¿≠µÕ£¨∑Ω±„≤˙…˙œ¬¥Œ…œ…˝—ÿ
 282   2              }                                        //—≠ª∑8¥Œ£¨Ω´8Œª ˝æ›»´≤ø¥Ê¥¢µΩ¡À¥Ê¥¢ ˝æ›ºƒ¥Ê∆˜÷–
 283   1                RCLK=1;                               //Ω´¥Ê¥¢ ˝æ›ºƒ¥Ê∆˜÷–µƒ ˝æ›∑¢ÀÕ∏¯HC595–æ∆¨ ‰≥ˆø⁄
 284   1                      _nop_();
 285   1                      _nop_(); 
 286   1                RCLK=0;
 287   1      }
 288          
 289          
 290          void LED_Key()                               //”¶”√4°¡4º¸≈Ã π ˝¬Îπ‹∂‘”√œ‘ æ0~F
 291          {
 292   1              LSA=0;
 293   1              LSB=0;
 294   1              LSC=0;
 295   1              while(1)
 296   1              {
 297   2                      Keydown();
 298   2                      LED=smgduan[Keyvalue];
 299   2                      Delay_ms(20); 
 300   2              }
 301   1      }
 302          
 303          void Keydown(void)                           //4°¡4æÿ’Ûº¸≈Ã—≠ª∑…®√Ë£¨¥”◊Û…œµΩ”“œ¬£¨“¿¥ŒŒ™ ˝¬Îπ‹ ˝◊È÷–µƒ0~F
 304          {
 305   1      //      static  uchar8 a=0;                     //æ÷≤øæ≤Ã¨±‰¡ø£¨¥À¥¶Ωˆ‘⁄≥Ã–Úƒ⁄≤ø“˝”√£¨÷ªª·‘⁄≥Ã–Ú ◊¥Œ÷¥–– ±±ª≥ı 
             -ºªØ£¨≥Ã–Ú÷¥––“ª¥Œ∫Ûª·±£¡Ù–¬÷µ£¨◊˜Œ™œ¬¥Œ≥Ã–Ú÷¥––µƒ≥ı º÷µ
 306   1              uchar8 a=0;                               //∂®“Âæ÷≤ø±‰¡ø£¨÷ª‘⁄∏√≥Ã–Úƒ⁄≤ø“˝”√,√ø¥Œ≥Ã–Ú÷¥––ø™ º∂ºª·±ª≥ı ºªØ
 307   1              GPIO_Key=0x0f;
 308   1              if(GPIO_Key!=0x0f)
 309   1              {
 310   2                      Delay_ms(10);                           //∞¥œ¬œ˚∂∂                 
 311   2                      if(GPIO_Key!=0x0f)                      //‘Ÿ¥Œ»∑»œ∞¥º¸»∑ µ∞¥œ¬
 312   2                      {
 313   3                              GPIO_Key=0x0f;                         //∞¥º¸∂Àø⁄÷ÿ–¬∏≥÷µ
 314   3                              switch(GPIO_Key)                      //¡–ºÏ≤‚      //…®√Ë «ƒƒ“ª¡–”–∞¥º¸∞¥œ¬
 315   3                              {
 316   4                                      case(0x07):Keyvalue=0;break;
 317   4                                      case(0x0b):Keyvalue=1;break;
 318   4                                      case(0x0d):Keyvalue=2;break;
 319   4                                      case(0x0e):Keyvalue=3;break;    
 320   4                              }
 321   3                              GPIO_Key=0xf0;                        //––ºÏ≤‚     //…®√Ë «ƒƒ“ª––”–∞¥º¸∞¥œ¬
 322   3                              switch(GPIO_Key)
 323   3                              {
 324   4                                      case(0x70):Keyvalue=Keyvalue;break;
 325   4                                      case(0xb0):Keyvalue=Keyvalue+4;break;
 326   4                                      case(0xd0):Keyvalue=Keyvalue+8;break;
C51 COMPILER V9.01   MIAN                                                                  10/27/2020 22:32:56 PAGE 7   

 327   4                                      case(0xe0):Keyvalue=Keyvalue+12;break;  
 328   4                              }
 329   3                              while((a<50)&&(GPIO_Key!=0xf0))        //œ˚∂∂£¨Õ¨ ±ºÏ≤‚∞¥º¸≥¨ ±”Î∑Ò£¨∑¿÷π≥÷–¯∞¥º¸’º”√CPU
 330   3                              {
 331   4                                      Delay_ms(10);
 332   4                                      a++;
 333   4                              }
 334   3                      }
 335   2              }
 336   1      }       
 337          
 338          
 339          void Key_Led(void)                          //∞¥º¸øÿ÷∆LEDµ„¡¡∫Õœ®√
 340          {       
 341   1                 if(K1==0)  
 342   1                      {       
 343   2                              Delay_ms(10);                                 //∞¥œ¬œ˚∂∂
 344   2                              if(K1==0)
 345   2                              {       while(!K1);                            //µ»¥˝∞¥º¸À…ø™°£
 346   3                                      Led2=~Led2;
 347   3                              }
 348   2                      }
 349   1      }
 350           void smgj(void)                               //æ≤Ã¨ ˝¬Îπ‹œ‘ æ           //74H573£®J21£©–æ∆¨£¨LEŒ™À¯¥Ê∂À£
             -¨µ±LE”ÎP10∂ÃΩ”£¨±Ì æÀ¯¥Ê∆˜◊¥Ã¨”…I/Oø⁄øÿ÷∆£¨µ±LE”ÎVCC∂ÃΩ” ±£¨±Ì æ”…Õ‚≤øµÁ‘¥øÿ÷∆
 351                                                                                                               //µ±LEŒ™∏ﬂµÁ
             -∆Ω ±£¨Ω¯–– ˝æ›µƒ≤…ºØ£¨D0~7µƒ÷µ”ÎQ0~7“ª“ª∂‘”¶£¨µ±LEŒ™µÕµÁ∆Ω ±£¨ª·À¯¥Ê÷Æ«∞µƒ ˝æ›£¨±£≥÷≤ª±‰
 352          {
 353   1              LSA=0;
 354   1              LSB=0;
 355   1              LSC=0;
 356   1              LED=smgduan[0];                            //µ˜”√ ˝◊Èµ⁄“ª∏ˆ‘™Àÿ£¨ π ˝¬Îπ‹œ‘ æ¡„
 357   1      }
 358          
 359          
 360          
 361          void smgd1(void)                             //æ≤Ã¨ ˝¬Îπ‹—≠ª∑œ‘ æ0~F 
 362          {
 363   1              uchar8 i;
 364   1              LSA=0;
 365   1              LSB=0;
 366   1              LSC=0;
 367   1              for(i=0;i<17;i++)
 368   1              {
 369   2                LED=smgduan[i];
 370   2                      Delay_s(1);
 371   2              }                                          //µ˜”√ ˝◊Èµ⁄“ª∏ˆ‘™Àÿ£¨ π ˝¬Îπ‹œ‘ æ¡„
 372   1      }
 373          
 374          
 375          
 376          void smgd2(void)                             //8∏ˆ ˝¬Îπ‹¡˜ÀÆ—≠ª∑œ‘ æ0~7
 377          {
 378   1              uchar8 i;
 379   1              for(i=0;i<8;i++)
 380   1              {
 381   2                      switch(i)
 382   2                      {
 383   3                              case(0):
 384   3                                            LSA=0;LSB=0;LSC=0;LED=smgduan[i];Delay_s(1);break;
 385   3                              case(1):
 386   3                                            LSA=1;LSB=0;LSC=0;LED=smgduan[i];Delay_s(1);break;
C51 COMPILER V9.01   MIAN                                                                  10/27/2020 22:32:56 PAGE 8   

 387   3                              case(2):
 388   3                                            LSA=0;LSB=1;LSC=0;LED=smgduan[i];Delay_s(1);break;
 389   3                              case(3):
 390   3                                            LSA=1;LSB=1;LSC=0;LED=smgduan[i];Delay_s(1);break;
 391   3                              case(4):
 392   3                                            LSA=0;LSB=0;LSC=1;LED=smgduan[i];Delay_s(1);break;
 393   3                              case(5):
 394   3                                            LSA=1;LSB=0;LSC=1;LED=smgduan[i];Delay_s(1);break;
 395   3                              case(6):
 396   3                                            LSA=0;LSB=1;LSC=1;LED=smgduan[i];Delay_s(1);break;
 397   3                              case(7):
 398   3                                            LSA=1;LSB=1;LSC=1;LED=smgduan[i];Delay_s(1);break;
 399   3                      }
 400   2              }
 401   1      }
 402          
 403          
 404          
 405          void FMQ(void)                                  //∑‰√˘∆˜≥Ã–Ú
 406          {
 407   1              FM=0;
 408   1              Delay_us(10);   
 409   1              FM=~FM;
 410   1                      Delay_us(10);                              //µ˜Ω⁄I/Oø⁄ ‰≥ˆ≤®–Œ’ºø’±»
 411   1      }
 412          
 413          
 414          
 415          void LED_one(void)                              //∂¿¡¢Ledµƒµ„¡¡”Îœ®√
 416          {
 417   1                Led2=0;
 418   1                      Delay_ms(100); 
 419   1                      Led2=~Led2;
 420   1                      Delay_ms(100); 
 421   1      }
 422          
 423          
 424          
 425          void LED_cror(void)                             //‘À”√—≠ª∑“∆Œª∫Ø ˝µ„¡¡LED¡˜ÀÆµ∆   —≠ª∑”““∆
 426          {
 427   1              while(1)
 428   1              {
 429   2          uint16 i;
 430   2                A=0xfe;
 431   2                Delay_ms(50);
 432   2                for(i=0;i<7;i++)
 433   2                  { 
 434   3                    A=_cror_(A,1);                         //—≠ª∑”““∆
 435   3                          Delay_ms(20);
 436   3                  }
 437   2                              
 438   2              }
 439   1      }
 440          
 441          
 442          
 443          void LED_crol1(void)                            //‘À”√ ˝◊È µœ÷LED¡˜ÀÆµ∆   —≠ª∑◊Û“∆
 444          {
 445   1              uchar8 table[]={0xfe,0xfd,0xfb,0xf7,0xef,0xdf,0xbf,0x7f};   // ˝◊Èµƒ∂®“Â
 446   1              while(1)
 447   1              {
 448   2                      uint16 n;
C51 COMPILER V9.01   MIAN                                                                  10/27/2020 22:32:56 PAGE 9   

 449   2                      for(n=0;n<8;n++)
 450   2                      {
 451   3                              A=table[n];                              //µ˜”√ ˝◊È÷–µ⁄n∏ˆ ˝
 452   3                              Delay_ms(20);
 453   3                      }
 454   2              }
 455   1      }
 456          
 457          
 458          
 459          void LED_crol2(void)                           //º∆ ˝–Õ¡˜ÀÆµ∆
 460          {
 461   1              uchar8 m=255;                
 462   1              while(1)
 463   1           {
 464   2             A=m;
 465   2                               Delay_ms(50);
 466   2                               m--;
 467   2           }
 468   1      }
 469          
 470          
 471          void Delay_s(uint16 n)                         //12Mæß’Ò—”≥Ÿn√Î
 472          {
 473   1              uint16 i=0;
 474   1              uint32 j=0;
 475   1              for(i=0;i<n;i++)
 476   1                  for(j=0;j<21738;j++);
 477   1      }
 478          
 479          
 480          
 481          void Delay_ms(uint16 n)                         //12Mæß’Ò—”≥Ÿn∫¡√Î
 482          {     
 483   1              uint16 i=0;
 484   1              uint32 j=0;
 485   1              for(i=0;i<n;i++)
 486   1                  for(j=0;j<123;j++);
 487   1      }
 488          
 489          
 490            
 491          void Delay_us(uint16 n)                         //12Mæß’Ò—”≥Ÿn/100∫¡√Î
 492          {
 493   1              while(n--);
 494   1      }       


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1235    ----
   CONSTANT SIZE    =     41    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      8      30
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)

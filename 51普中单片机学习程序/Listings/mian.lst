C51 COMPILER V9.01   MIAN                                                                  10/27/2020 22:32:56 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE MIAN
OBJECT MODULE PLACED IN .\Objects\mian.obj
COMPILER INVOKED BY: B:\Keil\C51\BIN\C51.EXE mian.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\mian.ls
                    -t) OBJECT(.\Objects\mian.obj)

line level    source

   1          #include <reg51.h>
   2          #include <intrins.h>
   3          #include <i2c.h>
   4          
   5          #define A P2                                //¶¨ÒåÒ»×éI/O¿Ú£¬·½±ã¶Ô¶à´¦µ÷ÓÃÍ¬Ò»I/OµÄÐÞ¸Ä£¨±ãÓÚ³ÌÐòÒÆÖ²£©  
             -          //#defineºê¶¨Òå£¬ÓÃÓÚ¶¨Òå³£Á¿£¨°üÀ¨ÎÞ²ÎÁ¿Óë´ø²ÎÁ¿£©
   6          #define LED P0                             //°Ë¶ÎÊýÂë¹ÜI/O¿Ú¶¨Òå
   7          #define GPIO_Key P1                        //¾ØÕó°´¼üI/O¿Ú¶¨
   8          
   9          typedef unsigned int uint16;
  10          typedef unsigned long int uint32;
  11          typedef unsigned char uchar8;
  12          
  13          
  14          sbit FM=P1^5;                             //¶¨Òå·äÃùÆ÷I/O¿Ú
  15          
  16          sbit LSA=P2^2;                            //¶¨ÒåÊýÂë¹ÜÆ¬Ñ¡ÐÅºÅI/O¿Ú
  17          sbit LSB=P2^3;                            //AÎªµÍÎ»£¬BÎª¸ßÎ»
  18          sbit LSC=P2^4;
  19          
  20          
  21          sbit Led2=P2^2;                          //¶¨Òå¶ÀÁ¢I/O¿Ú,±ãÓÚ¶Ô¶ÀÁ¢I/O¿ÚµÄ±æÊ¶ 
  22          
  23          sbit K2=P3^0; 
  24          sbit K1=P3^1;                            //¶¨Òå¶ÀÁ¢°´¼ü          ÎÄ¼þÈ«¾Ö±äÁ¿µÄ¶¨Òå£¬¸Ã±äÁ¿½öÔÚ¸Ã.cÎÄ¼þÖÐ±
             -»È«¾ÖÒýÓÃ                    
  25          sbit K3=P3^2;
  26          sbit K4=P3^3; 
  27          
  28          
  29          
  30          sbit SER=P3^4;                              //DS-´®ÐÐÊý¾ÝÊäÈë
  31          sbit RCLK=P3^5;                            //STCP-´æ´¢¼Ä´æÆ÷Ê±ÖÓ£¨´¥·¢¹¤×÷µÄÐÅºÅ£©ÊäÈë              
  32          sbit SRCLK=P3^6;                           //SHCP-ÒÆÎ»¼Ä´æÆ÷Ê±ÖÓ£¨´¥·¢¹¤×÷µÄÐÅºÅ£©ÊäÈë
  33           
  34          
  35          void Delay_s(uint16 n);                    //12M¾§ÕñÑÓ³ÙnÃë                  //ÑÓÊ±º¯ÊýµÄ¶¨Òå
  36          void Delay_ms(uint16 n);                   //12M¾§ÕñÑÓ³ÙnºÁÃë                
  37          void Delay_us(uint16 n);                  //12M¾§ÕñÑÓ³Ùn/100ºÁÃî
  38          
  39          void Keydown();                           //4¡Á4¾ØÕó¼üÅÌÑ­»·É¨Ãè£¬´Ó×óÉÏµ½ÓÒÏÂ£¬ÒÀ´ÎÎªÊýÂë¹ÜÊý×éÖÐµÄ0~F
  40          uchar8  Keyvalue;
  41          
  42          void Hc595SendByte(uchar8 dat);               //595ÏÈ´«ËÍ¸ßÎ»£¬ÔÙ´«ËÍµÍÎ»
  43          
  44          void Key_Led(void);                      //°´¼ü¿ØÖÆLEDµãÁÁºÍÏ¨Ãð
  45          void LED_Key();                          //Ó¦ÓÃ4¡Á4¼üÅÌÊ¹ÊýÂë¹Ü¶ÔÓÃÏÔÊ¾0~F
  46          void Key_Led(void);                      //°´¼ü¿ØÖÆLEDµãÁÁ
  47          
  48          void smgj(void);                         //¾²Ì¬ÊýÂë¹ÜÏÔÊ¾ 
  49          void smgd1(void);                        //¾²Ì¬ÊýÂë¹ÜÑ­»·ÏÔÊ¾0~F 
  50          void smgd2(void);                        //8¸öÊýÂë¹ÜÁ÷Ë®Ñ­»·ÏÔÊ¾0~7
  51          
  52          void FMQ(void);                          //·äÃùÆ÷³ÌÐò
C51 COMPILER V9.01   MIAN                                                                  10/27/2020 22:32:56 PAGE 2   

  53          
  54          void Keypros();
  55          void DigDisplay();
  56          void datapros();
  57          
  58          void Int0Init();                          //Íâ²¿ÖÐ¶Ï0³õÊ¼»¯³ÌÐò
  59                                                    //ÔËÓÃÍâ²¿ÖÐ¶Ï0¿ØÖÆ°´¼üK3ÊµÏÖ¶ÔLEDµÆD2µÄÁÁÃð¿ØÖÆ
  60          void Time0Init();                          //¶¨Ê±/¼ÆÊýÆ÷T0³õÊ¼»¯³ÌÐò¡ª¡ª¡ª¡ªÐèÔÚÖ÷º¯ÊýÖÐÒýÓÃ¸Äº¯Êý
  61                                                    //ÔËÓÃ¶¨Ê±/¼ÆÊýÆ÷TOÊµÏÖ¶ÔLEDµÆD2µÄÑ­»·µãÁÁ
  62          void UsartInit();                         //´®¿ÚÍ¨ÐÅ³õÊ¼»¯º¯Êý                         
  63                                                    //ÔËÓÃ¶¨Ê±Æ÷ÊµÏÖ´®¿ÚÍ¨ÐÅ
  64          
  65          void LED_one(void);                      //¶ÀÁ¢LedµÄµãÁÁ                    //Ö´ÐÐ³ÌÐòµÄ¶¨Òå
  66          void LED_cror(void);                     //ÔËÓÃÑ­»·ÒÆÎ»º¯ÊýµãLEDÁ÷Ë®µÆ
  67          void LED_crol1(void);                    //ÔËÓÃÊý×éÊµÏÖLEDÁ÷Ë®µÆ
  68          void LED_crol2(void);                   //¼ÆÊýÐÍÁ÷Ë®µÆ
  69          
  70          void HC595_send_data(uchar8 dat);      //LEDµãÕóÐÐÉ¨Ãè
  71          void Led_dz1(void);                        //ledµãÕóµãÁÁ×óÉÏ½ÇµÆ
  72          void LED_dianzhen_gexingzi(void);                                     //ÔËÓÃLEDµãÕó×Ô¶¨ÒåÏÔÊ¾ºº×Ö
  73          uchar8 code Led_duan[]={0x00,0x02,0x52,0x7e,0x52,0x7e,0x02,0x00};                   //ºº×Ö¡°³ó¡±
  74          //uchar8 code Led_duan[]={0xff,0x91,0xaf,0x8b,0x8b,0xaf,0x91,0xff};                 //ºº×Ö¡°‡å¡±
  75          //uchar8 code Led_duan[]={0x3c,0x42,0x00,0x42,0x24,0x18,0x24,0x42};                //×ÖÄ¸ CX
  76          //uchar8 code Led_duan[]={0x00,0x00,0x3e,0x41,0x41,0x41,0x3e,0x00};                //LEDµãÕóÏÔÊ¾Áã£¬¶ÎÑ¡ÐÅ
             -ºÅ£¨Ñ¡ÖÐÄ³¼¸ÐÐ£©---°´ÁÐ¶Á16Î»Öµ--¸Ä±ä´ËÊý×é£¬´ïµ½ÏÔÊ¾²»Í¬×ÖµÄÄ¿µØ
  77          uchar8 code Led_wei[]={0x7f,0xbf,0xdf,0xef,0xf7,0xfb,0xfd,0xfe};                   //LEDµãÕóÏÔÊ¾Áã£¬Î»Ñ¡ÐÅ
             -ºÅ£¨Ñ¡ÖÐÄ³ÁÐ£©---°´ÐÐ¶Á16Î»Öµ---±¾Êý×é²»±ä
  78          
  79          uchar8 code smgduan[]={0x3f,0x06,0x5b,0x4f,0x66,0x6d,0x7d,0x07,
  80                                 0x7f,0x6f,0x77,0x7c,0x39,0x5e,0x79,0x71,0x00};             //Æß¶ÎÊýÂë¹Ü¶ÔÓ¦0~FÏÔÊ¾Ö
             -µÊý×é               ÔÚ.cÎÄ¼þÖÐ¶¨ÒåÊý×é£¬Êý×é¿É´æ´¢ÔÚFlashÖÐ£¨¶¨ÒåÊ±¿É°üº¬code£©
  81          uchar8 num=0,disp[4];
  82          
  83                                                     
  84          void main()
  85          {
  86   1              while(1)
  87   1              {
  88   2                Keypros();
  89   2                datapros();
  90   2                DigDisplay();
  91   2              }
  92   1      }
  93          
  94          void Keypros()
  95          {
  96   1              if(K1==0)
  97   1              {
  98   2                      Delay_ms(5);
  99   2                      if(K1==0)
 100   2                      {
 101   3                              At24c02Write(1,num);
 102   3                      }
 103   2                  while(!K1);
 104   2              }
 105   1              if(K2==0)
 106   1              {
 107   2                      Delay_ms(5);
 108   2                      if(K2==0)
 109   2                      {
 110   3                              num=At24c02Read(1);
 111   3                      }       
C51 COMPILER V9.01   MIAN                                                                  10/27/2020 22:32:56 PAGE 3   

 112   2                      while(!K2);
 113   2              }
 114   1              if(K3==0)
 115   1              {
 116   2                      Delay_ms(5);
 117   2                      if(K3==0)
 118   2                      {
 119   3                              num++;
 120   3      //                      if(num>255)num=0;     //ifµ¥Óï¾äÖ´ÐÐÃüÁîÐ´·¨
 121   3                              if(num>255)           //ifÓï¾äµÄÍêÕûÓÃ·¨
 122   3                              {
 123   4                                      num=0;
 124   4                              }
 125   3                      }
 126   2                  while(!K3);
 127   2              }       
 128   1              if(K4==0)
 129   1              {
 130   2                      Delay_ms(5);
 131   2                      if(K4==0)
 132   2                      {
 133   3                              num=0;
 134   3                      }       
 135   2                      while(!K4);
 136   2              }       
 137   1      }
 138          
 139          void DigDisplay()
 140          {
 141   1              uchar8 i;
 142   1              for(i=0;i<4;i++)
 143   1              {
 144   2                      switch(i)        //Î»Ñ¡£¬Ñ¡ÔñµãÁÁµÄÊýÂë¹Ü£¬
 145   2                      {
 146   3                              case(0):
 147   3                                      LSA=0;LSB=0;LSC=0; break;//ÏÔÊ¾µÚ0Î»
 148   3                              case(1):
 149   3                                      LSA=1;LSB=0;LSC=0; break;//ÏÔÊ¾µÚ1Î»
 150   3                              case(2):
 151   3                                      LSA=0;LSB=1;LSC=0; break;//ÏÔÊ¾µÚ2Î»
 152   3                              case(3):
 153   3                                      LSA=1;LSB=1;LSC=0; break;//ÏÔÊ¾µÚ3Î»    
 154   3                      }
 155   2                      P0=disp[3-i];//·¢ËÍÊý¾Ý
 156   2                      Delay_ms(5); //¼ä¸ôÒ»¶ÎÊ±¼äÉ¨Ãè 
 157   2                      P0=0x00;//ÏûÒþ
 158   2              }               
 159   1      }
 160                  
 161          void datapros()
 162          {
 163   1              disp[0]=smgduan[num/1000];//Ç§Î»
 164   1              disp[1]=smgduan[num%1000/100];//°ÙÎ»
 165   1              disp[2]=smgduan[num%1000%100/10];//¸öÎ»
 166   1              disp[3]=smgduan[num%1000%100%10];               
 167   1      }
 168          
 169          void UsartInit()                                                   //´®¿ÚÍ¨ÐÅ³õÊ¼»¯º¯Êý 
 170          {                                                                  //ÔËÓÃ¶¨Ê±Æ÷ÊµÏÖ´®¿ÚÍ¨ÐÅ
 171   1              TMOD=0x20;                                                     //È·¶¨T1µÄ¹¤×÷·½Ê½0010 0000¡ª¡ªÑ¡ÔñT1¶¨Ê±/
             -¼ÆÊýÆ÷ Ñ¡Ôñ¶¨Ê±Ä£Ê½ ÉèÖÃ¹¤×÷·½Ê½Îª·½Ê½2  
 172   1              TH1=0xf3;                                                    //ÅäÖÃ¶¨Ê±Æ÷³õÖµ ÅäÖÃ¼Ä´æÆ÷¸ßËÄÎ»=³ÌÐò¼ÆËãÖµ
C51 COMPILER V9.01   MIAN                                                                  10/27/2020 22:32:56 PAGE 4   

             -¡ª¡ª¿ÉÓÃ51²¨ÌØÂÊ³õÖµÉè¶¨Ð¡³ÌÐò¼ÆËã
 173   1              TL1=0xf3;                                                   //               ÅäÖÃ¼Ä´æÆ÷µÍËÄÎ»=ÆäÖµÓë¸ßËÄÎ
             -»ÏàÍ¬
 174   1              PCON=0x80;                                                  //ÅäÖÃPCON¼Ä´æÆ÷¡ª¡ªÑ¡ÔñÊÇ·ñ½øÐÐ²¨ÌØÂÊ±¶ÔöÎ»£
             -¨SMOD£©1000 0000¡ª¡ªÔÚ·½Ê½1/2/3ÖÐ£¬²¨ÌØÂÊÓëSMODÓÐ¹Ø¡ª¡ªµ±SMOD=1Ê±£¬²¨ÌØÂÊÌá¸ßÒ»±¶£»¸´Î»Ê±£¬SMOD=0
 175   1              TR1=1;                                                     //Æô¶¯T1£¨±à³ÌTCONÖÐµÄTR1Î»£© ¿ª¶¨Ê±Æ÷£¬TR0=1Ê
             -±£¬¶¨Ê±Æ÷¿ªÊ¼¹¤×÷
 176   1              SCON=0x50;                                                 //È·¶¨´®ÐÐ¿Ú¿ØÖÆ£¨±à³ÌSCON¼Ä´æÆ÷£©0101 0000 SM
             -0=0£¬SM1=1Ñ¡Ôñ¿ØÖÆ·½Ê½Îª·½Ê½1 SM2=0¹Ø±Õ¶à»úÍ¨ÐÅ REN=1Æô¶¯´®ÐÐ¿Ú½ÓÊÕÊý¾Ý
 177   1              ES=1;                                                     //¿ª´®ÐÐ¿ÚÖÐ¶ÏÔÊÐíÎ»
 178   1              EA=1;                                                     //¿ªCPUÖÐ¶ÏÔÊÐí£¨×ÜÔÊÐíÎ»£©
 179   1      }
 180          
 181          void Usart() interrupt 4                                       //´®¿ÚÍ¨ÐÅ·þÎñº¯Êý              
 182          {
 183   1              uchar8 receiveData;                                        //¶¨ÒåÊý¾Ý´æ´¢±äÁ¿
 184   1              receiveData=SBUF;                                          //PC·¢ËÍÊý¾Ýµ½SBUF£¨´ËÊ±³äµ±Êý¾Ý½ÓÊÕ»º´æÆ÷£©ºó
             -£¬½«Æä¸³Öµ¸ø±äÁ¿½øÐÐ´¢´æ
 185   1              RI=0;                                                     //Ò»Ö¡Êý¾Ý´«Êä½áÊø»á³öÏÖÍ£Ö¹Î»£¨RI½ÓÊÕÖÐ¶Ï±êÖ¾Î
             -»£©£¬ÄÚ²¿Ó²¼þ»á×Ô¶¯Ê¹RI=1£¬ÏòÖÐ¶Ï·¢³öÖÐ¶ÏÉêÇë¡ª¡ªÎª±ãÓÚÏÂ´ÎÊý¾ÝµÄ½ÓÊÕ£¬¹Ê´Ë´¦ÐèÈí¼þ»ØÁã
 186   1              SBUF=receiveData;                                         //±äÁ¿½«Öµ¸³¸øSBUF£¨´ËÊ±³äµ±Êý¾Ý·¢ËÍ»º´æÆ÷£©£¬²
             -¢ÓÉPC¶ÁÈ¡SBUFÖÐµÄÊý¾Ý£¬´ïµ½ÏòPC·¢ËÍÊý¾ÝµÄÄ¿µÄ
 187   1              while(!TI);                                               //Êý¾ÝÎ´·¢ËÍÍêÊ±TI=0£»³ÌÐò»áÍ£ÔÚ¸Ã´¦£¬µÈ´ýÊý¾Ý·
             -¢ËÍ¡ª¡ªµ±Êý¾Ý·¢ËÍ½áÊøÊ±£¬³öÏÖ·¢ËÍÍ£Ö¹Î»£¬´ËÊ±ÄÚ²¿Ó²¼þ×Ô¶¯Ê¹TI=1£¬³ÌÐòÌø³ö¸ÃÓï¾ä£¬Í¬Ê±CPU·¢³öÖÐ¶ÏÉêÇë
 188   1              TI=0;                                                     //Ò»Ö¡Êý¾Ý´«Êä½áÊø»á³öÏÖÍ£Ö¹Î»£¨TI·¢ËÍÖÐ¶Ï±êÖ¾Î
             -»£©£¬ÄÚ²¿Ó²¼þ»á×Ô¶¯Ê¹TI=1£¬ÏòÖÐ¶Ï·¢³öÖÐ¶ÏÉêÇë¡ª¡ªÎª±ãÓÚÏÂ´ÎÊý¾ÝµÄ·¢ËÍ£¬¹Ê´Ë´¦ÐèÈí¼þ»ØÁã
 189   1      }
 190          
 191          //void main£¨£©                                                   //ÖÐ¶Ï/¶¨Ê±Æ÷Õý½â
 192          //{
 193          //      Time0Init();
 194          //      while(1);                                                    //ÒýÓÃÍâ²¿ÖÐ¶Ï»òÕß¶¨Ê±Æ÷Ê±£¬±ØÐëÓÐ´Ëwhile½
             -á¹¹ÌåÓï¾ä
 195          //}
 196          
 197          
 198          //void main£¨£©                                                   //ÖÐ¶Ï/¶¨Ê±Æ÷´íÎóÐ´·¨
 199          //{
 200          //      while(1)                                                      //ÒýÓÃÍâ²¿ÖÐ¶Ï»òÕß¶¨Ê±Æ÷Ê±£¬²»ÄÜ²ÉÓÃ´Ëwhi
             -le½á¹¹ÌåÓï¾ä
 201          //      {
 202          //        Time0Init();
 203          //      }                                                    
 204          //}
 205          
 206          
 207          void Time0Init()                                                     //¶¨Ê±/¼ÆÊýÆ÷T0³õÊ¼»¯º¯Êý¡ª¡ª¡ª¡ªÐèÔÚ
             -Ö÷º¯ÊýÖÐÒýÓÃ¸Äº¯Êý
 208          {                                                                   //ÔËÓÃ¶¨Ê±/¼ÆÊýÆ÷TOÊµÏÖ¶ÔLEDµÆD2µÄÑ­»·
             -µãÁÁ
 209   1      //  TMOD=0x01;
 210   1              TMOD|=0x01;                                                     //´Ë·¨±È½ÏÉÏÌõÓï¾ä¿ÉÔö¼Ó³ÌÐòÎÈ¶¨ÐÔ ¹¤×÷·½
             -Ê½¼Ä´æÆ÷ÅäÖÃ¡ª¡ª0000 0001¡ª¡ªÑ¡ÔñT0¶¨Ê±/¼ÆÊýÆ÷ Ñ¡Ôñ¶¨Ê±Ä£Ê½ ÉèÖÃ¹¤×÷·½Ê½Îª·½Ê½1  GATE£¨ÃÅ¿ÕÎ»£©=0Ê±£¬¿ØÖÆ¶¨Ê±Æ÷µÄÆô¶¯ÊÜÍ
             -â²¿ÖÐ¶ÏÔ´ÐÅºÅµÄÓ°Ïì£¬Ö»ÒªÓÃÈí¼þÊ¹TCONÖÐµÄTR0»òTR1Îª1£¬²Å¿ÉÒÔÆô¶¯¶¨Ê±/¼ÆÊýÆ÷
 211   1              TH0=0xfc;                                                     //ÅäÖÃ¶¨Ê±Æ÷³õÖµ ÅäÖÃ¼Ä´æÆ÷¸ßËÄÎ»¡ª¡ª³õÖµ=6
             -5536-¶¨Ê±Ê±¼ä=65535-¶¨Ê±Ê±¼ä+1                                                   GATE£¨ÃÅ¿ÕÎ»£©=1Ê±£¬ÒªÓÃÈí¼þÊ¹TR0»òTR1Î
             -ª1£¬Í¬Ê±Íâ²¿ÖÐ¶ÏÒý½ÅINT0/1Ò²Îª¸ßµçÆ½Ê±£¬²ÅÄÜÆô¶¯¶¨Ê±/¼ÆÊýÆ÷¹¤×÷
 212   1              TL0=0x18;                                                                    //ÅäÖÃ¶¨Ê±Æ÷µÍËÄÎ» 
 213   1              ET0=1;                                                     //¶¨Ê±/¼ÆÊýÆ÷ÖÐ¶ÏÔÊÐíÎ»
 214   1              EA=1;                                                     //CPUÖÐ¶ÏÔÊÐíÎ»£¨×ÜÔÊÐíÎ»=ÖÐ¶Ï×Ü¿ª¹Ø£©
 215   1              TR0=1;                                                     //¿ª¶¨Ê±Æ÷£¬TR0=1Ê±£¬¶¨Ê±Æ÷¿ªÊ¼¹¤×÷
 216   1      }
C51 COMPILER V9.01   MIAN                                                                  10/27/2020 22:32:56 PAGE 5   

 217          
 218          void Time0() interrupt 1                                      //¶¨Ê±/¼ÆÊýÆ÷·þÎñº¯Êý¡ª¡ªÖÐ¶Ï·¢ÉúÊ±×Ô¶¯Ö´ÐÐ¸
             -Ã×Óº¯Êý¡ª¡ªÖ÷º¯ÊýÖÐÎÞÐèµ÷ÓÃ
 219          {
 220   1              static uint16 i;                                         //¾Ö²¿(½öÔÚ¸Ã×Óº¯ÊýÖÐ¶¨ÒåµÄ±äÁ¿)¾²Ì¬±äÁ¿£¬´Ë´¦½ö
             -ÔÚ³ÌÐòÄÚ²¿ÒýÓÃ£¬Ö»»áÔÚ³ÌÐòÊ×´ÎÖ´ÐÐÊ±±»³õÊ¼»¯£¬³ÌÐòÖ´ÐÐÒ»´Îºó»á±£ÁôÐÂÖµ£¬×÷ÎªÏÂ´Î³ÌÐòÖ´ÐÐµÄ³õÊ¼Öµ
 221   1              TH0=0xfc;                                                //ÅäÖÃ¶¨Ê±Æ÷³õÖµ ÅäÖÃ¼Ä´æÆ÷¸ßËÄÎ»
 222   1              TL0=0x18;                                                              //ÅäÖÃ¶¨Ê±Æ÷µÍËÄÎ»¡ª¡ª´Ë¹¤×÷·½Ê½ÏÂ
             -£¨·½Ê½1£©£¬ÎÞ·¨×Ô¶¯ÖØ×°³õÖµ£¬¹ÊÐèÔÚÖÐ¶ÏÖ´ÐÐ×Óº¯ÊýÖÐÊÖ¶¯ÖØ×°³õÖµ
 223   1              i++;                                                    //µ±¼ÆÊýÆ÷¼ÆÂú£¬·¢ÉúÒç³öÊ±Ìø×ªÖÁ¸Ã×Óº¯Êý£¬Ö´ÐÐµ½´
             -ËÓï¾äÊ±£¬Ìø³öÖÐ¶Ï£¬Ã¿´Î¸Ã×Óº¯ÊýÖ´ÐÐÒ»´Î£¬±íÊ¾ÒÑ¾­¼ÆÊý1ms£¨iÖ´ÐÐi+1²Ù×÷£©£¬
 224   1              if(i==1000)                                                    //µ±iÀÛ¼ÓÖÁ1000£¨¼´1s£©Ê±£¬Ö´ÐÐ¸ÃifÓï¾ä£¬Ê
             -µÏÖLEDµÆD1µÄ×´Ì¬Ìø±ä
 225   1              {
 226   2                      i=0;                                                    //Ã¿´ÎLED×´Ì¬Ìø±äºó£¬Ðè½«iÇåÁã£¬ÈÃÆäÖØÐÂ¼ÆÊý£¬±ã
             -ÓÚ¼ÆËãÏÂ´ÎÌø±äÊ±¼ä
 227   2                      Led2=~Led2;
 228   2              }
 229   1      }
 230          
 231          
 232          void Int0Init()                                                //Íâ²¿ÖÐ¶Ï0³õÊ¼»¯³ÌÐò¡ª¡ªÐèÔÚÖ÷º¯ÊýÖÐÒýÓÃ¸Ä
             -º¯Êý¡ª¡ªÖ÷º¯ÊýÖÐÎÞÐèµ÷ÓÃ
 233          {                                                              //ÔËÓÃÍâ²¿ÖÐ¶Ï0¿ØÖÆ°´¼üK3ÊµÏÖ¶ÔLEDµÆD1µÄÁÁÃ
             -ð¿ØÖÆ
 234   1              IT0=1;                                                     //Íâ²¿ÖÐ¶Ï0´¥·¢·½Ê½¿ØÖÆÎ»¡ª¡ªIT0=0Ê±ÎªµÍµçÆ½´¥
             -·¢£»IT0=1Ê±ÎªÏÂ½µÑØ´¥·¢
 235   1              EX0=1;                                                     //Íâ²¿ÖÐ¶Ï0ÖÐ¶Ï¿ØÖÆ±êÖ¾Î»
 236   1              EA=1;                                                     //CPUÖÐ¶ÏÔÊÐí£¨×ÜÔÊÐíÎ»=ÖÐ¶Ï×Ü¿ª¹Ø£©
 237   1      }
 238          
 239          void Int0() interrupt 0                                      // ÖÐ¶Ï·þÎñº¯Êý¡ª¡ªÖÐ¶Ï·¢ÉúÊ±£¬ÐèÒªÖ´ÐÐµÄ¶¯×÷
             -£¨Ö÷º¯ÊýÖÐ²»µ÷ÓÃ¸Ã×Óº¯Êý£©     //void   Int0()         interrupt       0
 240          {                                                                                                         
             -                          //      ÖÐ¶Ïº¯ÊýÃû                     ÖÐ¶ÏºÅ
 241   1              Delay_ms(5);
 242   1              if(K3==0)
 243   1              {
 244   2                      Led2=~Led2;
 245   2              }
 246   1      }
 247          
 248          
 249          void LED_dianzhen_gexingzi(void)                                     //ÔËÓÃLEDµãÕó×Ô¶¨ÒåÏÔÊ¾ºº×Ö
 250          {
 251   1                      uchar8 i;
 252   1                      LED=0x7f;
 253   1                      for(i=0;i<8;i++)
 254   1                      {
 255   2                              LED=Led_wei[i];                 //½øÐÐÁÐÉ¨Ãè
 256   2                              Hc595SendByte(Led_duan[i]);     //½øÐÐÐÐÉ¨Ãè
 257   2                              Delay_us(100);
 258   2                              Hc595SendByte(0x00);            //¶ÔµãÕóÇåÆÁ
 259   2                      }
 260   1      }
 261                                                                                                   
 262          void Led_dz1(void)                         //ledµãÕóµãÁÁ×óÉÏ½ÇµÆ
 263          {   
 264   1          Hc595SendByte(0x80);                      //Ñ¡ÔñÐÐ
 265   1          LED=0x7f;                                  //Ñ¡ÔñÁÐ
 266   1      }
 267          
C51 COMPILER V9.01   MIAN                                                                  10/27/2020 22:32:56 PAGE 6   

 268          
 269          void Hc595SendByte(uchar8 dat)           //ÐÐÑ¡Ôñ/¶ÎÑ¡º¯Êý       //HC595ÏÈ´«ËÍ¸ßÎ»£¬ÔÙ´«ËÍµÍÎ»  µ±OE£¨JOE£
             -©ÎªµÍµçÆ½Ê±Ð¾Æ¬¹¤×÷
 270          {
 271   1              uchar8 i;
 272   1              SRCLK=0;                                  //SHCP-ÒÆÎ»¼Ä´æÆ÷Ê±ÖÓ£¨´¥·¢¹¤×÷µÄÐÅºÅ£©ÊäÈë
 273   1              RCLK=0;                                   //STCP-´æ´¢¼Ä´æÆ÷Ê±ÖÓ£¨´¥·¢¹¤×÷µÄÐÅºÅ£©ÊäÈë  
 274   1              for(i=0;i<8;i++)                            //Ö´ÐÐ8´Îºó½«8Î»Êý¾Ý´æ´¢ÖÁÒÆÎ»Êý¾Ý´æ´¢¼Ä´æÆ÷  
 275   1              {
 276   2                      SER=dat>>7;                             //a=0Ê±£¬·¢ËÍ×î¸ßÎ»£¬Èç£ºdat=10101110 ,ÔòÓÒÒÆÆß´Îºó£¬½öÊ£ÏÂ×î¸ßÎ
             -»µÄ1£¬
 277   2                      dat<<=1;                                                         //¸ßÎ»¡ª¡ªµÍÎ»
 278   2                      SRCLK=1; 
 279   2                      _nop_();                               //Ö´ÐÐÒ»´ÎÑÓÊ±Ò»¸ö»úÆ÷ÖÜÆÚ
 280   2                      _nop_();                
 281   2                      SRCLK=0;                                //½«ÒÆÎ»¼Ä´æÆ÷À­µÍ£¬·½±ã²úÉúÏÂ´ÎÉÏÉýÑØ
 282   2              }                                        //Ñ­»·8´Î£¬½«8Î»Êý¾ÝÈ«²¿´æ´¢µ½ÁË´æ´¢Êý¾Ý¼Ä´æÆ÷ÖÐ
 283   1                RCLK=1;                               //½«´æ´¢Êý¾Ý¼Ä´æÆ÷ÖÐµÄÊý¾Ý·¢ËÍ¸øHC595Ð¾Æ¬Êä³ö¿Ú
 284   1                      _nop_();
 285   1                      _nop_(); 
 286   1                RCLK=0;
 287   1      }
 288          
 289          
 290          void LED_Key()                               //Ó¦ÓÃ4¡Á4¼üÅÌÊ¹ÊýÂë¹Ü¶ÔÓÃÏÔÊ¾0~F
 291          {
 292   1              LSA=0;
 293   1              LSB=0;
 294   1              LSC=0;
 295   1              while(1)
 296   1              {
 297   2                      Keydown();
 298   2                      LED=smgduan[Keyvalue];
 299   2                      Delay_ms(20); 
 300   2              }
 301   1      }
 302          
 303          void Keydown(void)                           //4¡Á4¾ØÕó¼üÅÌÑ­»·É¨Ãè£¬´Ó×óÉÏµ½ÓÒÏÂ£¬ÒÀ´ÎÎªÊýÂë¹ÜÊý×éÖÐµÄ0~F
 304          {
 305   1      //      static  uchar8 a=0;                     //¾Ö²¿¾²Ì¬±äÁ¿£¬´Ë´¦½öÔÚ³ÌÐòÄÚ²¿ÒýÓÃ£¬Ö»»áÔÚ³ÌÐòÊ×´ÎÖ´ÐÐÊ±±»³õÊ
             -¼»¯£¬³ÌÐòÖ´ÐÐÒ»´Îºó»á±£ÁôÐÂÖµ£¬×÷ÎªÏÂ´Î³ÌÐòÖ´ÐÐµÄ³õÊ¼Öµ
 306   1              uchar8 a=0;                               //¶¨Òå¾Ö²¿±äÁ¿£¬Ö»ÔÚ¸Ã³ÌÐòÄÚ²¿ÒýÓÃ,Ã¿´Î³ÌÐòÖ´ÐÐ¿ªÊ¼¶¼»á±»³õÊ¼»¯
 307   1              GPIO_Key=0x0f;
 308   1              if(GPIO_Key!=0x0f)
 309   1              {
 310   2                      Delay_ms(10);                           //°´ÏÂÏû¶¶                 
 311   2                      if(GPIO_Key!=0x0f)                      //ÔÙ´ÎÈ·ÈÏ°´¼üÈ·Êµ°´ÏÂ
 312   2                      {
 313   3                              GPIO_Key=0x0f;                         //°´¼ü¶Ë¿ÚÖØÐÂ¸³Öµ
 314   3                              switch(GPIO_Key)                      //ÁÐ¼ì²â      //É¨ÃèÊÇÄÄÒ»ÁÐÓÐ°´¼ü°´ÏÂ
 315   3                              {
 316   4                                      case(0x07):Keyvalue=0;break;
 317   4                                      case(0x0b):Keyvalue=1;break;
 318   4                                      case(0x0d):Keyvalue=2;break;
 319   4                                      case(0x0e):Keyvalue=3;break;    
 320   4                              }
 321   3                              GPIO_Key=0xf0;                        //ÐÐ¼ì²â     //É¨ÃèÊÇÄÄÒ»ÐÐÓÐ°´¼ü°´ÏÂ
 322   3                              switch(GPIO_Key)
 323   3                              {
 324   4                                      case(0x70):Keyvalue=Keyvalue;break;
 325   4                                      case(0xb0):Keyvalue=Keyvalue+4;break;
 326   4                                      case(0xd0):Keyvalue=Keyvalue+8;break;
C51 COMPILER V9.01   MIAN                                                                  10/27/2020 22:32:56 PAGE 7   

 327   4                                      case(0xe0):Keyvalue=Keyvalue+12;break;  
 328   4                              }
 329   3                              while((a<50)&&(GPIO_Key!=0xf0))        //Ïû¶¶£¬Í¬Ê±¼ì²â°´¼ü³¬Ê±Óë·ñ£¬·ÀÖ¹³ÖÐø°´¼üÕ¼ÓÃCPU
 330   3                              {
 331   4                                      Delay_ms(10);
 332   4                                      a++;
 333   4                              }
 334   3                      }
 335   2              }
 336   1      }       
 337          
 338          
 339          void Key_Led(void)                          //°´¼ü¿ØÖÆLEDµãÁÁºÍÏ¨Ãð
 340          {       
 341   1                 if(K1==0)  
 342   1                      {       
 343   2                              Delay_ms(10);                                 //°´ÏÂÏû¶¶
 344   2                              if(K1==0)
 345   2                              {       while(!K1);                            //µÈ´ý°´¼üËÉ¿ª¡£
 346   3                                      Led2=~Led2;
 347   3                              }
 348   2                      }
 349   1      }
 350           void smgj(void)                               //¾²Ì¬ÊýÂë¹ÜÏÔÊ¾           //74H573£¨J21£©Ð¾Æ¬£¬LEÎªËø´æ¶Ë£
             -¬µ±LEÓëP10¶Ì½Ó£¬±íÊ¾Ëø´æÆ÷×´Ì¬ÓÉI/O¿Ú¿ØÖÆ£¬µ±LEÓëVCC¶Ì½ÓÊ±£¬±íÊ¾ÓÉÍâ²¿µçÔ´¿ØÖÆ
 351                                                                                                               //µ±LEÎª¸ßµç
             -Æ½Ê±£¬½øÐÐÊý¾ÝµÄ²É¼¯£¬D0~7µÄÖµÓëQ0~7Ò»Ò»¶ÔÓ¦£¬µ±LEÎªµÍµçÆ½Ê±£¬»áËø´æÖ®Ç°µÄÊý¾Ý£¬±£³Ö²»±ä
 352          {
 353   1              LSA=0;
 354   1              LSB=0;
 355   1              LSC=0;
 356   1              LED=smgduan[0];                            //µ÷ÓÃÊý×éµÚÒ»¸öÔªËØ£¬Ê¹ÊýÂë¹ÜÏÔÊ¾Áã
 357   1      }
 358          
 359          
 360          
 361          void smgd1(void)                             //¾²Ì¬ÊýÂë¹ÜÑ­»·ÏÔÊ¾0~F 
 362          {
 363   1              uchar8 i;
 364   1              LSA=0;
 365   1              LSB=0;
 366   1              LSC=0;
 367   1              for(i=0;i<17;i++)
 368   1              {
 369   2                LED=smgduan[i];
 370   2                      Delay_s(1);
 371   2              }                                          //µ÷ÓÃÊý×éµÚÒ»¸öÔªËØ£¬Ê¹ÊýÂë¹ÜÏÔÊ¾Áã
 372   1      }
 373          
 374          
 375          
 376          void smgd2(void)                             //8¸öÊýÂë¹ÜÁ÷Ë®Ñ­»·ÏÔÊ¾0~7
 377          {
 378   1              uchar8 i;
 379   1              for(i=0;i<8;i++)
 380   1              {
 381   2                      switch(i)
 382   2                      {
 383   3                              case(0):
 384   3                                            LSA=0;LSB=0;LSC=0;LED=smgduan[i];Delay_s(1);break;
 385   3                              case(1):
 386   3                                            LSA=1;LSB=0;LSC=0;LED=smgduan[i];Delay_s(1);break;
C51 COMPILER V9.01   MIAN                                                                  10/27/2020 22:32:56 PAGE 8   

 387   3                              case(2):
 388   3                                            LSA=0;LSB=1;LSC=0;LED=smgduan[i];Delay_s(1);break;
 389   3                              case(3):
 390   3                                            LSA=1;LSB=1;LSC=0;LED=smgduan[i];Delay_s(1);break;
 391   3                              case(4):
 392   3                                            LSA=0;LSB=0;LSC=1;LED=smgduan[i];Delay_s(1);break;
 393   3                              case(5):
 394   3                                            LSA=1;LSB=0;LSC=1;LED=smgduan[i];Delay_s(1);break;
 395   3                              case(6):
 396   3                                            LSA=0;LSB=1;LSC=1;LED=smgduan[i];Delay_s(1);break;
 397   3                              case(7):
 398   3                                            LSA=1;LSB=1;LSC=1;LED=smgduan[i];Delay_s(1);break;
 399   3                      }
 400   2              }
 401   1      }
 402          
 403          
 404          
 405          void FMQ(void)                                  //·äÃùÆ÷³ÌÐò
 406          {
 407   1              FM=0;
 408   1              Delay_us(10);   
 409   1              FM=~FM;
 410   1                      Delay_us(10);                              //µ÷½ÚI/O¿ÚÊä³ö²¨ÐÎÕ¼¿Õ±È
 411   1      }
 412          
 413          
 414          
 415          void LED_one(void)                              //¶ÀÁ¢LedµÄµãÁÁÓëÏ¨Ãð
 416          {
 417   1                Led2=0;
 418   1                      Delay_ms(100); 
 419   1                      Led2=~Led2;
 420   1                      Delay_ms(100); 
 421   1      }
 422          
 423          
 424          
 425          void LED_cror(void)                             //ÔËÓÃÑ­»·ÒÆÎ»º¯ÊýµãÁÁLEDÁ÷Ë®µÆ   Ñ­»·ÓÒÒÆ
 426          {
 427   1              while(1)
 428   1              {
 429   2          uint16 i;
 430   2                A=0xfe;
 431   2                Delay_ms(50);
 432   2                for(i=0;i<7;i++)
 433   2                  { 
 434   3                    A=_cror_(A,1);                         //Ñ­»·ÓÒÒÆ
 435   3                          Delay_ms(20);
 436   3                  }
 437   2                              
 438   2              }
 439   1      }
 440          
 441          
 442          
 443          void LED_crol1(void)                            //ÔËÓÃÊý×éÊµÏÖLEDÁ÷Ë®µÆ   Ñ­»·×óÒÆ
 444          {
 445   1              uchar8 table[]={0xfe,0xfd,0xfb,0xf7,0xef,0xdf,0xbf,0x7f};   //Êý×éµÄ¶¨Òå
 446   1              while(1)
 447   1              {
 448   2                      uint16 n;
C51 COMPILER V9.01   MIAN                                                                  10/27/2020 22:32:56 PAGE 9   

 449   2                      for(n=0;n<8;n++)
 450   2                      {
 451   3                              A=table[n];                              //µ÷ÓÃÊý×éÖÐµÚn¸öÊý
 452   3                              Delay_ms(20);
 453   3                      }
 454   2              }
 455   1      }
 456          
 457          
 458          
 459          void LED_crol2(void)                           //¼ÆÊýÐÍÁ÷Ë®µÆ
 460          {
 461   1              uchar8 m=255;                
 462   1              while(1)
 463   1           {
 464   2             A=m;
 465   2                               Delay_ms(50);
 466   2                               m--;
 467   2           }
 468   1      }
 469          
 470          
 471          void Delay_s(uint16 n)                         //12M¾§ÕñÑÓ³ÙnÃë
 472          {
 473   1              uint16 i=0;
 474   1              uint32 j=0;
 475   1              for(i=0;i<n;i++)
 476   1                  for(j=0;j<21738;j++);
 477   1      }
 478          
 479          
 480          
 481          void Delay_ms(uint16 n)                         //12M¾§ÕñÑÓ³ÙnºÁÃë
 482          {     
 483   1              uint16 i=0;
 484   1              uint32 j=0;
 485   1              for(i=0;i<n;i++)
 486   1                  for(j=0;j<123;j++);
 487   1      }
 488          
 489          
 490            
 491          void Delay_us(uint16 n)                         //12M¾§ÕñÑÓ³Ùn/100ºÁÃë
 492          {
 493   1              while(n--);
 494   1      }       


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1235    ----
   CONSTANT SIZE    =     41    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      8      30
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
